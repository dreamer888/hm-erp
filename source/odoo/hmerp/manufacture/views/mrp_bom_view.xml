<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="mrp_bom_tree" model="ir.ui.view">
        <field name="name">mrp.bom.tree</field>
        <field name="model">mrp.bom</field>
        <field name="arch" type="xml">
            <tree string='Bom清单'>
                <field name='bom_code'  optional="show"/>
                <field name='bom_ver'  optional="show"/>
                <field name='bom_name' optional="show"/>
                <field name='mrp_bom_category_id' optional="show"/>
                <field name='department_id' optional="show"/>
                <field name='goods_id' optional="show"/>
                <field name='uom_id' optional="show"/>
                <field name='qty' optional="show"/>
                <field name='warehouse_id' optional="show"/>
                <field name='remark' optional="show"/>
                <field name='stop_date' optional="show"/>
                <field name='state' optional="show"/>
                <field name='active'  invisible='1' optional="show"/>
            </tree>
        </field>
    </record>

    <record id='mrp_bom_form' model='ir.ui.view'>
        <field name='name'>mrp.bom.form</field>
        <field name='model'>mrp.bom</field>
        <field name='arch' type='xml'>
            <form string='Bom清单信息'>
                <header>
                    <button name='mrp_bom_done' states='draft' string='确认' type='object' class='oe_highlight'/>
                    <button name="mrp_bom_draft" states="done" string="撤销" type="object"/>
                    <button name="button_copy_bom" string="BOM复制" type="object"/>
                    <field name='state' widget='statusbar' statusbar_visible="draft,done"/>
                </header>
                <sheet>
                    <group>
                        <group>
					        <field name="bom_code" />
                            <field name="bom_name" />
                            <field name="mrp_bom_category_id" />
                            <field name="department_id" options="{'no_create': True,'no_create_edit': True}"/>
                            <field name="warehouse_id" options="{'no_create': True,'no_create_edit': True}"/>
                        </group>
                        <group>
                            <field name="bom_ver" />
                            <field name="goods_id" options="{'no_create': True,'no_create_edit': True}"/>
                            <field name="uom_id" options="{'no_create': True,'no_create_edit': True}"/>
                            <field name="qty" />
                            <field name="stop_date" />
                        </group>
                        <field name="mrp_proc_ids" invisible="1"/>
                    </group>
                    <group>
                        <field name="remark" optional="show"/>
                    </group>
                    <notebook>
                        <page name="lines" string="物料">
                            <field name="line_ids">
                                <tree string="物料" editable="bottom">
                                    <field name="sequence" widget="handle"/>
                                    <field name="goods_id" optional="show" options="{'no_create': True, 'no_create_edit': True}"/>
                                    <field name="mrp_proc_id" optional="show"
                                           domain="[('id', 'in', parent.mrp_proc_ids)]"
                                           options="{'no_create': True,'no_create_edit': True}"/>
                                    <field name="uom_id" optional="show" options="{'no_create': True,'no_create_edit': True}"/>
                                    <field name="qty" sum="数量合计" optional="show"/>
                                    <field name="radix" optional="show"/>
                                    <field name="warehouse_id" optional="show" options="{'no_create': True,'no_create_edit': True}"/>
                                    <field name="rate_waste" optional="show"/>
                                    <field name="bom_id" domain="[('id', '!=', parent.id)]" optional="show"
                                           context="{'goods_id':goods_id}"/>
                                    <field name="remark" optional="show"/>
                                </tree>
                            </field>
                        </page>
                        <page name="proc_lines" string="工艺">
                            <field name="line_proc_ids">
                                <tree string="工艺" editable='bottom'>
                                    <field name="sequence" widget="handle"/>
                                    <field name="mrp_proc_id" optional="show" options="{'no_create': True, 'no_create_edit': True}"/>
                                    <field name="down" optional="show"/>
                                    <field name='proc_ctl' optional="show"/>
                                    <field name="need_qc" optional="show"/>
                                    <field name="qc_department_id" optional="show" options="{'no_create': True, 'no_create_edit': True}"/>
                                    <field name="workcenter_id" optional="show" options="{'no_create': True, 'no_create_edit': True}"/>
                                    <field name="get_way" optional="show"/>
                                    <field name="rate_self" optional="show"/>
                                    <field name="sub_remark" optional="show"/>
                                    <field name="rate_waste" optional="show"/>
                                    <field name="time_uom" optional="show"/>
                                    <field name="pre_time" optional="show"/>
                                    <field name="work_time" optional="show"/>
                                    <field name="price_std" optional="show"/>
                                    <field name="price" optional="show"/>
                                    <field name="remark" optional="show"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!--Bom清单 action-->
    <record id="mrp_bom_action" model="ir.actions.act_window">
        <field name="name">Bom清单</field>
        <field name="res_model">mrp.bom</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref='mrp_bom_tree'/>
        <field name="help" type="html">
           <p class="oe_view_nocontent_create">
                 点击创建Bom清单
           </p>
         </field>
    </record>
    <record id="mrp_bom_search" model="ir.ui.view">
        <field name="name"> Mrp Bom Search</field>
        <field name="model">mrp.bom</field>
        <field name="arch" type="xml">
            <search string='BOM'>
                <field name='bom_code'/>
                <field name='bom_name'/>
                <filter string="已归档" name="inactive" domain="[('active','=',False)]"/>
            </search>
        </field>
    </record>
</odoo>