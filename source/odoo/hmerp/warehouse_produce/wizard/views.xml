<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="action_produce" model="ir.actions.act_window">
        <field name="name">报工</field>
        <field name="res_model">wh.produce.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

    <record id="wh_produce_wizard_view_form" model="ir.ui.view">
        <field name="name">wh.produce.wizard.view.form</field>
        <field name="model">wh.produce.wizard</field>
        <field name="arch" type="xml">
            <form string="">
                <sheet>
                    <group>
                        <field name="note" readonly='1' nolabel='1'/>
                        <field name="qty" />
                        <field name="date" />
                    </group>
                    <group string="产出成品">
                        <field nolabel="1" name="line_in_ids" context="{'default_type': 'in'}">
                            <tree editable='top'>
                                <field name="goods_id" required='1' options="{'no_open': True, 'no_create': True}"/>
                                <field name='attribute_id'
                                    domain="[('goods_id', '=', goods_id)]"
                                    options="{'no_open': True, 'no_create': True}"
                                    attrs="{'required': [('using_attribute', '=', True)], 'readonly': ['|', ('using_attribute', '=', False), ('state', '=', 'done')]}"
                                    groups='goods.multi_attrs_groups'/>
                                <field name='lot'
                                    groups='goods.batch_groups'
                                    attrs="{'readonly': ['|', ('using_batch', '=', False), ('state', '=', 'done')], 'required': [('using_batch', '=', True)]}"/>
                                <field name='location_id' groups="warehouse.multi_location_groups" options="{'no_open': True, 'no_create': True}"/>
                                <field name='goods_qty' attrs="{'readonly': ['|', ('force_batch_one', '=', True), ('state', '=', 'done')]}" sum='1'/>
                                <field name='uom_id' readonly='1'/>
                                <field name="scrap"/>
                                <field name='using_batch' invisible='1'/>
                                <field name='force_batch_one' invisible='1'/>
                                <field name='using_attribute' invisible='1'/>
                                <field name='type' invisible='1'/>
                                <field name='state' invisible='1'/>
                            </tree>
                        </field>
                    </group>
                    <group string="投入材料">
                        <field nolabel="1" name="line_out_ids" context="{'default_type': 'out'}">
                            <tree editable='top'>
                                <field name="goods_id" required='1' />
                                <field name='attribute_id'
                                    domain="[('goods_id', '=', goods_id)]"
                                    attrs="{'required': [('using_attribute', '=', True)], 'readonly': ['|', ('using_attribute', '=', False), ('state', '=', 'done')]}"
                                    groups='goods.multi_attrs_groups'/>
                                <field name="warehouse_id" invisible="1"/>
                                <field name='lot_id'
                                    groups='goods.batch_groups'
                                    attrs="{'readonly': ['|', ('using_batch', '=', False), ('state', '=', 'done')], 'required': [('using_batch', '=', True)]}"/>
                                <field name='location_id' groups="warehouse.multi_location_groups" options="{'no_open': True, 'no_create': True}"/>
                                <field name='goods_qty' attrs="{'readonly': ['|', ('force_batch_one', '=', True), ('state', '=', 'done')]}" sum='1'/>
                                <field name='uom_id' readonly='1'/>
                                <field name="all_lack"/>
                                <field name="wh_lack"/>
                                <field name='using_batch' invisible='1'/>
                                <field name='force_batch_one' invisible='1'/>
                                <field name='using_attribute' invisible='1'/>
                                <field name='type' invisible='1'/>
                                <field name='state' invisible='1'/>
                            </tree>
                        </field>
                    </group>
                </sheet>
                <footer>
                    <button string="确认" name="button_ok" type="object" class="oe_highlight"/>
                    <button string="取消" special='cancel'/>
                </footer>
            </form>
        </field>
    </record>
</odoo>
